<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Localizador de Cor</title>
</head>
<body>
    <h2>Localizador de Cor PANTONE</h2>
    <input type="file" id="fileInput" accept=".xml">
    <br>
    <input type="number" id="inputL" placeholder="L">
    <input type="number" id="inputA" placeholder="A">
    <input type="number" id="inputB" placeholder="B">
    <button onclick="findColor()">Encontrar Cor</button>
    <div id="colorName">Nome da cor aparecerá aqui...</div>

    <script>
        function findColor() {
            const fileInput = document.getElementById('fileInput').files[0];
            if (!fileInput) {
                alert("Por favor, carregue um arquivo XML.");
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(text, "text/xml");
                const colors = xmlDoc.getElementsByTagName("cc:ColorCIELab");

                let found = false;
                for (let color of colors) {
                    const L = color.getElementsByTagName("cc:L")[0].textContent;
                    const A = color.getElementsByTagName("cc:A")[0].textContent;
                    const B = color.getElementsByTagName("cc:B")[0].textContent;

                    const inputL = document.getElementById("inputL").value;
                    const inputA = document.getElementById("inputA").value;
                    const inputB = document.getElementById("inputB").value;

                    if (Math.abs(L - inputL) < 0.01 && Math.abs(A - inputA) < 0.01 && Math.abs(B - inputB) < 0.01) {
                        const name = color.parentNode.parentNode.getAttribute("Name");
                        document.getElementById("colorName").innerText = "Nome da cor: " + name;
                        found = true;
                        break;
                    }
                }

                if (!found) {
                    document.getElementById("colorName").innerText = "Cor não encontrada.";
                }
            };
            reader.readAsText(fileInput);
        }
    </script>
</body>
</html>
